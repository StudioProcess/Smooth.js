<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smooth.js Demo</title>
  <script src="./lib/Smooth.js"></script>
</head>
<body>
  <canvas id="canvas" style="border:1px solid;"></canvas>
  <div id="ui">
    <fieldset>
        <legend>method</legend>
        <label><input type="radio" name="method" value="nearest"> nearest</label><br/>
        <label><input type="radio" name="method" value="linear"> linear</label><br/>
        <label><input type="radio" name="method" value="cubic" checked> cubic</label><br/>
        <label><input type="radio" name="method" value="sinc"> sinc</label><br/>
        <label><input type="radio" name="method" value="lanczos"> lanczos</label><br/>
    </fieldset>
    <fieldset>
        <legend>clip</legend>
        <label><input type="radio" name="clip" value="clamp"> clamp</label><br/>
        <label><input type="radio" name="clip" value="zero"> zero</label><br/>
        <label><input type="radio" name="clip" value="periodic"> periodic</label><br/>
        <label><input type="radio" name="clip" value="mirror" checked> mirror</label><br/>
    </fieldset>
    <fieldset>
        <legend>cubicTension</legend>
        <label><input type="radio" name="cubicTension" value="0" checked> CUBIC_TENSION_CATMULL_ROM</label><br/>
        <label><input type="radio" name="cubicTension" value="0"> CUBIC_TENSION_DEFAULT</label><br/>
        <label><input type="radio" name="cubicTension" value="0"> 0</label><br/>
        <label><input type="radio" name="cubicTension" value="0.25"> 0.25</label><br/>
        <label><input type="radio" name="cubicTension" value="0.5"> 0.50</label><br/>
        <label><input type="radio" name="cubicTension" value="0.75"> 0.75</label><br/>
        <label><input type="radio" name="cubicTension" value="1"> 1</label><br/>
    </fieldset>
    <button>New Points</button>
    
    <script type="module">
      function radioValue(name) {
        return document.querySelector(`input[type=radio][name=${name}]:checked`).value;
      }
      
      function range(stop) {
        let out = [];
        for (let i=0; i<stop; i++) {
          out.push(i);
        }
        return out;
      }
      
      const max = 1000;
      const r = 3;
      
      const canvas = document.querySelector('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = max;
      canvas.height = max;
      canvas.style.width = max/2 + 'px';
      canvas.style.height = max/2 + 'px';
      let points = [];
      let int = [];
      
      function generatePoints(num) {
        points = range(num).map(i => [Math.random()*max*.9, Math.random()*max*.9]);
        // console.log(points);
      }
      
      function interpolate(res = 10) {
        let method = radioValue('method');
        let clip = radioValue('clip');
        let cubicTension = radioValue('cubicTension');
        let sincFilterSize = 2;
        let sincWindow = x => Math.exp(-x * x);
        let s = Smooth(points, { method, clip, cubicTension, sincFilterSize, sincWindow });
        
        int = [];
        for (let p=-1; p<points.length; p++) {
          for (let i=0; i<=res; i++) {
            let u = p + i/res;
            console.log(u);
            int.push( s(u) );
          }
        }
        console.log(int);
        
        ctx.beginPath();
        ctx.moveTo(int[0][0], int[0][1]);
        int.forEach(p => {
          ctx.lineTo(p[0], p[1]);
        });
        ctx.stroke();

      }
  
      function clear() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }
      
      function drawPoints() {
        points.forEach(p => {
          ctx.beginPath();
          ctx.arc( p[0], p[1], r, 0, 2*Math.PI);
          // ctx.stroke();
          ctx.fill();
        });
      }
      
      function drawNewPoints() {
        clear();
        generatePoints(5);
        drawPoints();
        interpolate();
      }
      
      function drawNewIntermediates() {
        clear();
        drawPoints();
        interpolate();
      }
      
      document.querySelector('button').addEventListener('click', drawNewPoints);
      
      // console.log(document.querySelector('input[type=radio]'));
      document.querySelectorAll('input[type=radio]').forEach(e => {
        e.addEventListener('change', drawNewIntermediates);
      });
      
      drawNewPoints();

    </script>
  </div>
</body>
</html>
